Index: src/CLI/Application.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?php declare(strict_types=1);\n/*\n * This file is part of PHP Copy/Paste Detector (PHPCPD).\n *\n * (c) Sebastian Bergmann <sebastian@phpunit.de>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\nnamespace SebastianBergmann\\PHPCPD;\n\nuse const PHP_EOL;\nuse function count;\nuse function printf;\nuse SebastianBergmann\\FileIterator\\Facade;\nuse SebastianBergmann\\PHPCPD\\Detector\\Detector;\nuse SebastianBergmann\\PHPCPD\\Detector\\Strategy\\AbstractStrategy;\nuse SebastianBergmann\\PHPCPD\\Detector\\Strategy\\DefaultStrategy;\nuse SebastianBergmann\\PHPCPD\\Detector\\Strategy\\StrategyConfiguration;\nuse SebastianBergmann\\PHPCPD\\Detector\\Strategy\\SuffixTreeStrategy;\nuse SebastianBergmann\\PHPCPD\\Log\\PMD;\nuse SebastianBergmann\\PHPCPD\\Log\\Text;\nuse SebastianBergmann\\Timer\\ResourceUsageFormatter;\nuse SebastianBergmann\\Timer\\Timer;\nuse SebastianBergmann\\Version;\n\nfinal class Application\n{\n    private const VERSION = '7.0';\n\n    public function run(array $argv): int\n    {\n        $this->printVersion();\n\n        try {\n            $arguments = (new ArgumentsBuilder)->build($argv);\n        } catch (Exception $e) {\n            print PHP_EOL . $e->getMessage() . PHP_EOL;\n\n            return 1;\n        }\n\n        if ($arguments->version()) {\n            return 0;\n        }\n\n        print PHP_EOL;\n\n        if ($arguments->help()) {\n            $this->help();\n\n            return 0;\n        }\n\n        $files = (new Facade)->getFilesAsArray(\n            $arguments->directories(),\n            $arguments->suffixes(),\n            '',\n            $arguments->exclude()\n        );\n\n        if (empty($files)) {\n            print 'No files found to scan' . PHP_EOL;\n\n            return 1;\n        }\n\n        $config = new StrategyConfiguration($arguments);\n\n        try {\n            $strategy = $this->pickStrategy($arguments->algorithm(), $config);\n        } catch (InvalidStrategyException $e) {\n            print $e->getMessage() . PHP_EOL;\n\n            return 1;\n        }\n\n        $timer = new Timer;\n        $timer->start();\n\n        $clones = (new Detector($strategy))->copyPasteDetection($files);\n\n        (new Text)->printResult($clones, $arguments->verbose());\n\n        if ($arguments->pmdCpdXmlLogfile()) {\n            (new PMD($arguments->pmdCpdXmlLogfile()))->processClones($clones);\n        }\n\n        print (new ResourceUsageFormatter)->resourceUsage($timer->stop()) . PHP_EOL;\n\n        return count($clones) > 0 ? 1 : 0;\n    }\n\n    private function printVersion(): void\n    {\n        printf(\n            'phpcpd %s by Sebastian Bergmann.' . PHP_EOL,\n            (new Version(self::VERSION, dirname(__DIR__)))->getVersion()\n        );\n    }\n\n    /**\n     * @throws InvalidStrategyException\n     */\n    private function pickStrategy(?string $algorithm, StrategyConfiguration $config): AbstractStrategy\n    {\n        return match ($algorithm) {\n            null, 'rabin-karp' => new DefaultStrategy($config),\n            'suffixtree' => new SuffixTreeStrategy($config),\n            default      => throw new InvalidStrategyException('Unsupported algorithm: ' . $algorithm),\n        };\n    }\n\n    private function help(): void\n    {\n        print <<<'EOT'\nUsage:\n  phpcpd [options] <directory>\n\nOptions for selecting files:\n\n  --suffix <suffix> Include files with names ending in <suffix> in the analysis\n                    (default: .php; can be given multiple times)\n  --exclude <path>  Exclude files with <path> in their path from the analysis\n                    (can be given multiple times)\n\nOptions for analysing files:\n\n  --fuzzy             Fuzz variable names\n  --min-lines <N>     Minimum number of identical lines (default: 5)\n  --min-tokens <N>    Minimum number of identical tokens (default: 70)\n  --algorithm <name>  Select which algorithm to use ('rabin-karp' (default) or 'suffixtree')\n  --edit-distance <N> Distance in number of edits between two clones (only for suffixtree; default: 5)\n  --head-equality <N> Minimum equality at start of clone (only for suffixtree; default 10)\n\nOptions for report generation:\n\n  --log-pmd <file>  Write log in PMD-CPD XML format to <file>\n\nEOT;\n    }\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/CLI/Application.php b/src/CLI/Application.php
--- a/src/CLI/Application.php	(revision 7724245f9d3aeae612efdc66925cf0f3f70f9a61)
+++ b/src/CLI/Application.php	(date 1704827299052)
@@ -26,7 +26,7 @@
 
 final class Application
 {
-    private const VERSION = '7.0';
+    private const VERSION = '6.0.4';
 
     public function run(array $argv): int
     {
@@ -94,8 +94,8 @@
     private function printVersion(): void
     {
         printf(
-            'phpcpd %s by Sebastian Bergmann.' . PHP_EOL,
-            (new Version(self::VERSION, dirname(__DIR__)))->getVersion()
+            '%s',
+            (new Version(self::VERSION, dirname(__DIR__)))->asString()
         );
     }
 
Index: build.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project name=\"phpcpd\" default=\"setup\">\n    <target name=\"setup\" depends=\"clean,install-dependencies\"/>\n\n    <target name=\"clean\" description=\"Cleanup build artifacts\">\n        <delete dir=\"${basedir}/vendor\"/>\n        <delete file=\"${basedir}/composer.lock\"/>\n        <delete>\n            <fileset dir=\"${basedir}/build\">\n                <include name=\"**/phpcpd*.phar\"/>\n                <include name=\"**/phpcpd*.phar.asc\"/>\n            </fileset>\n        </delete>\n    </target>\n\n    <target name=\"install-dependencies\" unless=\"dependencies-installed\" depends=\"-dependencies-installed\" description=\"Install dependencies with Composer\">\n        <exec executable=\"${basedir}/tools/composer\" taskname=\"composer\">\n            <arg value=\"update\"/>\n            <arg value=\"--no-interaction\"/>\n            <arg value=\"--no-progress\"/>\n            <arg value=\"--no-ansi\"/>\n        </exec>\n    </target>\n\n    <target name=\"update-tools\">\n        <exec executable=\"phive\">\n            <arg value=\"--no-progress\"/>\n            <arg value=\"update\"/>\n        </exec>\n    </target>\n\n    <target name=\"signed-phar\" description=\"Create signed PHAR archive of PHPCPD and all its dependencies (release)\" depends=\"phar\">\n        <exec executable=\"bash\" outputproperty=\"version\">\n            <arg value=\"-c\" />\n            <arg value=\"${basedir}/phpcpd --version | awk 'BEGIN { ORS = &quot;&quot;; } {print $2}'\" />\n        </exec>\n\n        <exec executable=\"gpg\" failonerror=\"true\">\n            <arg value=\"--armor\" />\n            <arg value=\"--detach-sign\" />\n            <arg path=\"${basedir}/build/phpcpd-${version}.phar\" />\n        </exec>\n    </target>\n\n    <target name=\"phar\" description=\"Create PHAR archive of phpcpd and all its dependencies\" depends=\"setup,phar-build\">\n    </target>\n\n    <target name=\"phar-build\">\n        <exec executable=\"bash\" outputproperty=\"version\">\n            <arg value=\"-c\" />\n            <arg value=\"${basedir}/phpcpd --version | awk 'BEGIN { ORS = &quot;&quot;; } {print $2}'\" />\n        </exec>\n\n        <copy todir=\"${basedir}/build/phar/src\">\n            <fileset dir=\"${basedir}/src\">\n                <include name=\"**/*.php\" />\n            </fileset>\n        </copy>\n\n        <copy file=\"${basedir}/vendor/sebastian/cli-parser/LICENSE\" tofile=\"${basedir}/build/phar/sebastian-cli-parser/LICENSE\"/>\n        <copy todir=\"${basedir}/build/phar/sebastian-cli-parser\">\n            <fileset dir=\"${basedir}/vendor/sebastian/cli-parser/src\">\n                <include name=\"**/*.php\" />\n            </fileset>\n        </copy>\n\n        <copy file=\"${basedir}/vendor/sebastian/version/LICENSE\" tofile=\"${basedir}/build/phar/sebastian-version/LICENSE\"/>\n        <copy todir=\"${basedir}/build/phar/sebastian-version\">\n            <fileset dir=\"${basedir}/vendor/sebastian/version/src\">\n                <include name=\"**/*.php\" />\n            </fileset>\n        </copy>\n\n        <copy file=\"${basedir}/vendor/phpunit/php-file-iterator/LICENSE\" tofile=\"${basedir}/build/phar/phpunit-php-file-iterator/LICENSE\"/>\n        <copy todir=\"${basedir}/build/phar/phpunit-php-file-iterator\">\n            <fileset dir=\"${basedir}/vendor/phpunit/php-file-iterator/src\">\n                <include name=\"**/*.php\" />\n            </fileset>\n        </copy>\n\n        <copy file=\"${basedir}/vendor/phpunit/php-timer/LICENSE\" tofile=\"${basedir}/build/phar/phpunit-php-timer/LICENSE\"/>\n        <copy todir=\"${basedir}/build/phar/phpunit-php-timer\">\n            <fileset dir=\"${basedir}/vendor/phpunit/php-timer/src\">\n                <include name=\"**/*.php\" />\n            </fileset>\n        </copy>\n\n        <exec executable=\"${basedir}/build/phar-manifest.php\" output=\"${basedir}/build/phar/manifest.txt\"/>\n\n        <exec executable=\"${basedir}/tools/phpab\">\n            <arg value=\"--all\" />\n            <arg value=\"--phar\" />\n            <arg value=\"--hash\" />\n            <arg value=\"SHA-512\" />\n            <arg value=\"--output\" />\n            <arg path=\"${basedir}/build/phpcpd-${version}.phar\" />\n            <arg value=\"--template\" />\n            <arg path=\"${basedir}/build/phar-autoload.php.in\" />\n            <arg value=\"--indent\" />\n            <arg value=\"            \" />\n            <arg path=\"${basedir}/build/phar\" />\n        </exec>\n\n        <chmod file=\"${basedir}/build/phpcpd-${version}.phar\" perm=\"ugo+rx\"/>\n\n        <delete dir=\"${basedir}/build/phar\"/>\n    </target>\n\n    <target name=\"-dependencies-installed\">\n        <available file=\"${basedir}/vendor\" property=\"dependencies-installed\" type=\"dir\"/>\n    </target>\n</project>\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/build.xml b/build.xml
--- a/build.xml	(revision 7724245f9d3aeae612efdc66925cf0f3f70f9a61)
+++ b/build.xml	(date 1704827005761)
@@ -1,5 +1,7 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <project name="phpcpd" default="setup">
+    <property name="basedir" value="." override="false"/>
+    <property name="version" value="6.0.4" override="true"/>
     <target name="setup" depends="clean,install-dependencies"/>
 
     <target name="clean" description="Cleanup build artifacts">
@@ -32,10 +34,10 @@
     <target name="signed-phar" description="Create signed PHAR archive of PHPCPD and all its dependencies (release)" depends="phar">
         <exec executable="bash" outputproperty="version">
             <arg value="-c" />
-            <arg value="${basedir}/phpcpd --version | awk 'BEGIN { ORS = &quot;&quot;; } {print $2}'" />
+            <arg value="${basedir}/phpcpd --version" />
         </exec>
 
-        <exec executable="gpg" failonerror="true">
+        <exec executable="gpg">
             <arg value="--armor" />
             <arg value="--detach-sign" />
             <arg path="${basedir}/build/phpcpd-${version}.phar" />
@@ -48,7 +50,7 @@
     <target name="phar-build">
         <exec executable="bash" outputproperty="version">
             <arg value="-c" />
-            <arg value="${basedir}/phpcpd --version | awk 'BEGIN { ORS = &quot;&quot;; } {print $2}'" />
+            <arg value="${basedir}/phpcpd --version" />
         </exec>
 
         <copy todir="${basedir}/build/phar/src">
@@ -101,7 +103,7 @@
             <arg path="${basedir}/build/phar" />
         </exec>
 
-        <chmod file="${basedir}/build/phpcpd-${version}.phar" perm="ugo+rx"/>
+        <chmod file="${basedir}/build/phpcpd-${version}.phar" mode="755"/>
 
         <delete dir="${basedir}/build/phar"/>
     </target>
Index: src/Detector/Strategy/AbstractStrategy.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?php declare(strict_types=1);\n/*\n * This file is part of PHP Copy/Paste Detector (PHPCPD).\n *\n * (c) Sebastian Bergmann <sebastian@phpunit.de>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\nnamespace SebastianBergmann\\PHPCPD\\Detector\\Strategy;\n\nuse const T_CLOSE_TAG;\nuse const T_COMMENT;\nuse const T_DOC_COMMENT;\nuse const T_INLINE_HTML;\nuse const T_NS_SEPARATOR;\nuse const T_OPEN_TAG;\nuse const T_OPEN_TAG_WITH_ECHO;\nuse const T_USE;\nuse const T_WHITESPACE;\nuse SebastianBergmann\\PHPCPD\\CodeCloneMap;\n\nabstract class AbstractStrategy\n{\n    /**\n     * @psalm-var array<int,true>\n     */\n    protected array $tokensIgnoreList = [\n        T_INLINE_HTML        => true,\n        T_COMMENT            => true,\n        T_DOC_COMMENT        => true,\n        T_OPEN_TAG           => true,\n        T_OPEN_TAG_WITH_ECHO => true,\n        T_CLOSE_TAG          => true,\n        T_WHITESPACE         => true,\n        T_USE                => true,\n        T_NS_SEPARATOR       => true,\n    ];\n\n    protected StrategyConfiguration $config;\n\n    public function __construct(StrategyConfiguration $config)\n    {\n        $this->config = $config;\n    }\n\n    public function setConfig(StrategyConfiguration $config): void\n    {\n        $this->config = $config;\n    }\n\n    abstract public function processFile(string $file, CodeCloneMap $result): void;\n\n    public function postProcess(): void\n    {\n    }\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/Detector/Strategy/AbstractStrategy.php b/src/Detector/Strategy/AbstractStrategy.php
--- a/src/Detector/Strategy/AbstractStrategy.php	(revision 7724245f9d3aeae612efdc66925cf0f3f70f9a61)
+++ b/src/Detector/Strategy/AbstractStrategy.php	(date 1704828054076)
@@ -18,6 +18,7 @@
 use const T_OPEN_TAG_WITH_ECHO;
 use const T_USE;
 use const T_WHITESPACE;
+use const T_ATTRIBUTE;
 use SebastianBergmann\PHPCPD\CodeCloneMap;
 
 abstract class AbstractStrategy
@@ -35,6 +36,7 @@
         T_WHITESPACE         => true,
         T_USE                => true,
         T_NS_SEPARATOR       => true,
+        T_ATTRIBUTE          => true,
     ];
 
     protected StrategyConfiguration $config;
Index: .phive/phars.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<phive xmlns=\"https://phar.io/phive\">\n  <phar name=\"phpunit\" version=\"^9.5\" installed=\"9.5.27\" location=\"./tools/phpunit\" copy=\"true\"/>\n  <phar name=\"phpab\" version=\"^1.26\" installed=\"1.27.1\" location=\"./tools/phpab\" copy=\"true\"/>\n  <phar name=\"php-cs-fixer\" version=\"^3.0\" installed=\"3.13.1\" location=\"./tools/php-cs-fixer\" copy=\"true\"/>\n  <phar name=\"psalm\" version=\"^4.0\" installed=\"4.30.0\" location=\"./tools/psalm\" copy=\"true\"/>\n  <phar name=\"composer\" version=\"^2.0\" installed=\"2.5.1\" location=\"./tools/composer\" copy=\"true\"/>\n</phive>\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.phive/phars.xml b/.phive/phars.xml
--- a/.phive/phars.xml	(revision 7724245f9d3aeae612efdc66925cf0f3f70f9a61)
+++ b/.phive/phars.xml	(date 1704825452442)
@@ -1,8 +1,8 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <phive xmlns="https://phar.io/phive">
-  <phar name="phpunit" version="^9.5" installed="9.5.27" location="./tools/phpunit" copy="true"/>
-  <phar name="phpab" version="^1.26" installed="1.27.1" location="./tools/phpab" copy="true"/>
-  <phar name="php-cs-fixer" version="^3.0" installed="3.13.1" location="./tools/php-cs-fixer" copy="true"/>
+  <phar name="phpunit" version="^9.5" installed="9.6.15" location="./tools/phpunit" copy="true"/>
+  <phar name="phpab" version="^1.26" installed="1.29.0" location="./tools/phpab" copy="true"/>
+  <phar name="php-cs-fixer" version="^3.0" installed="3.46.0" location="./tools/php-cs-fixer" copy="true"/>
   <phar name="psalm" version="^4.0" installed="4.30.0" location="./tools/psalm" copy="true"/>
-  <phar name="composer" version="^2.0" installed="2.5.1" location="./tools/composer" copy="true"/>
+  <phar name="composer" version="^2.0" installed="2.6.6" location="./tools/composer" copy="true"/>
 </phive>
